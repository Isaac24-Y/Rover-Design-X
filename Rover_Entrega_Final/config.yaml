# ========================================
# config.yaml - ConfiguraciÃ³n del Sistema
# ========================================

# ConfiguraciÃ³n de red
network:
  raspberry_ip: "172.32.200.137"
  udp_port: 50000
  tcp_port: 50001
  buffer_size: 4096
  timeout: 3.0

# ConfiguraciÃ³n serial
serial:
  port: "/dev/ttyUSB0"  # Linux: /dev/ttyUSB0 o /dev/ttyACM0
  baud_rate: 115200
  timeout: 1.0
  retries: 3

# ConfiguraciÃ³n de cÃ¡maras
cameras:
  front:
    device: 0
    width: 640
    height: 480
    fps: 30
  top:
    device: 2
    width: 640
    height: 480
    fps: 30

# ConfiguraciÃ³n de video streaming
video:
  jpeg_quality: 70
  frame_delay: 0.03  # ~30 FPS

# ConfiguraciÃ³n de detecciÃ³n de marcadores
markers:
  key_marker: "CÃ­rculo"  # Cruz, T, CÃ­rculo, Cuadrado, TriÃ¡ngulo
  confidence_threshold: 0.75
  template_size: 50

# ConfiguraciÃ³n de archivos CSV
csv:
  output_dir: "data"
  markers_file: "marcadores.csv"
  logs_file: "logs.csv"
  telemetry_file: "telemetria.csv"

# ConfiguraciÃ³n de sensores (calibraciÃ³n)
sensors:
  ldr:
    voltage_divider_r1: 10000  # 10kÎ©
    voltage_divider_r2: 10000  # 10kÎ©
  
  dht11:
    pin: A1
    type: "DHT11"
  
  vl53l0x:
    i2c_address: 0x29
    timing_budget: 33  # ms
  
  mpu6050:
    i2c_address: 0x68
    accel_range: 2  # Â±2g
    gyro_range: 250  # Â±250Â°/s
  
  ek1940:
    pin: A2
    calibration_dry: 550
    calibration_wet: 280

# ConfiguraciÃ³n de motores
motors:
  max_speed: 100
  min_speed: 0
  acceleration_step: 10
  pwm_frequency: 1000  # Hz

# ConfiguraciÃ³n de servos
servos:
  servo1:  # CÃ¡mara frontal
    pin: 6
    min_angle: 0
    max_angle: 30
    default_angle: 15
  
  servo2:  # Brazo - hombro
    pin: 7
    min_angle: 0
    max_angle: 180
    default_angle: 90
  
  servo3:  # Brazo - codo
    pin: 8
    min_angle: 0
    max_angle: 180
    default_angle: 90
  
  servo4:  # Sensor humedad
    pin: 9
    min_angle: 0
    max_angle: 90
    default_angle: 45

# ConfiguraciÃ³n de seguridad
safety:
  emergency_stop_enabled: true
  watchdog_timeout: 5000  # ms
  max_no_communication: 10  # segundos

# ConfiguraciÃ³n de logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  console_output: true
  file_output: true
  max_log_size: 10485760  # 10 MB
  backup_count: 5

---

# ========================================
# requirements.txt - Dependencias Python
# ========================================

# Para Raspberry Pi (servidor)
opencv-python==4.8.1.78
numpy==1.24.3
pyserial==3.5
PyYAML==6.0.1

# Para Cliente
opencv-python==4.8.1.78
numpy==1.24.3
Pillow==10.0.0

# LibrerÃ­as opcionales
# scipy==1.11.2  # Para procesamiento de seÃ±ales
# matplotlib==3.7.2  # Para grÃ¡ficas

---

# ========================================
# README.md - DocumentaciÃ³n Principal
# ========================================

# ğŸš€ Sistema de Rover de ExploraciÃ³n v2.0

Sistema completo para control de rover de exploraciÃ³n con capacidades manuales y autÃ³nomas.

## ğŸ“‹ CaracterÃ­sticas

- âœ… Control manual por GUI o teclado (WASD/flechas)
- âœ… Modo autÃ³nomo con detecciÃ³n de marcadores
- âœ… Streaming de video dual (cÃ¡mara frontal y superior)
- âœ… TelemetrÃ­a en tiempo real
- âœ… Sistema de guardado CSV
- âœ… Mapa 2D generado en tiempo real
- âœ… Control de 4 servos independientes
- âœ… Parada de emergencia
- âœ… Logging completo de eventos

## ğŸ”§ Hardware Requerido

### Arduino Nano
- 1x Arduino Nano
- 2x Puentes H (L298N o similar)
- 4x Servos (SG90 o equivalente)
- 1x Sensor DHT11
- 1x Fotorresistor (LDR) + resistencia 10kÎ©
- 1x Sensor VL53L0X
- 1x IMU MPU6050
- 1x Sensor capacitivo EK1940
- Cables, fuente de alimentaciÃ³n, etc.

### Raspberry Pi
- 1x Raspberry Pi 3/4
- 2x CÃ¡maras USB o CSI
- Tarjeta SD (16GB mÃ­nimo)
- Adaptador WiFi (si es necesario)

## ğŸ“¦ InstalaciÃ³n

### 1. Arduino Nano

```bash
# Instalar Arduino IDE
# Abrir archivo: arduino_firmware.ino
# Instalar librerÃ­as requeridas:
# - Servo (incluida)
# - Wire (incluida)
# - Adafruit_VL53L0X
# - DHT sensor library

# Conectar Arduino y subir el firmware
```

### 2. Raspberry Pi

```bash
# Actualizar sistema
sudo apt update && sudo apt upgrade -y

# Instalar dependencias
sudo apt install python3-pip python3-opencv -y

# Clonar/copiar archivos del proyecto
cd ~
mkdir rover_system
cd rover_system

# Instalar dependencias Python
pip3 install -r requirements.txt

# Dar permisos al puerto serial
sudo usermod -a -G dialout $USER
# Reiniciar sesiÃ³n despuÃ©s de esto

# Configurar inicio automÃ¡tico (opcional)
sudo nano /etc/rc.local
# Agregar antes de "exit 0":
# python3 /home/pi/rover_system/server.py &
```

### 3. Cliente (Computadora de control)

```bash
# Instalar Python 3.8+
# https://www.python.org/downloads/

# Instalar dependencias
pip install -r requirements.txt

# Editar config.yaml con la IP correcta de la Raspberry Pi

# Ejecutar cliente
python client_gui.py
```

## ğŸš€ Uso

### Iniciar Sistema

1. **Arduino:** Conectar y verificar que estÃ© encendido
2. **Raspberry Pi:** 
   ```bash
   cd ~/rover_system
   python3 server.py
   ```
3. **Cliente:** 
   ```bash
   python client_gui.py
   ```

### Controles

#### Teclado
- `W` / `â†‘` : Avanzar
- `S` / `â†“` : Retroceder
- `A` / `â†` : Girar izquierda
- `D` / `â†’` : Girar derecha

#### Botones
- **Modo Manual:** Control directo por usuario
- **Modo AutomÃ¡tico:** DetecciÃ³n y respuesta a marcadores
- **EMERGENCIA STOP:** Detiene todos los motores inmediatamente

## ğŸ“Š Estructura de Archivos

```
rover_system/
â”œâ”€â”€ arduino_firmware.ino      # Firmware para Arduino
â”œâ”€â”€ server.py                  # Servidor Raspberry Pi
â”œâ”€â”€ client_gui.py             # Cliente GUI
â”œâ”€â”€ config.yaml               # ConfiguraciÃ³n
â”œâ”€â”€ requirements.txt          # Dependencias Python
â”œâ”€â”€ data/                     # Datos generados
â”‚   â”œâ”€â”€ marcadores.csv
â”‚   â”œâ”€â”€ logs.csv
â”‚   â””â”€â”€ telemetria.csv
â”œâ”€â”€ docs/                     # DocumentaciÃ³n
â”‚   â”œâ”€â”€ architecture.md
â”‚   â”œâ”€â”€ protocol.md
â”‚   â””â”€â”€ troubleshooting.md
â””â”€â”€ tests/                    # Scripts de prueba
    â”œâ”€â”€ test_serial.py
    â”œâ”€â”€ test_video.py
    â””â”€â”€ simulator.py
```

## ğŸ” Troubleshooting

### Arduino no responde
```bash
# Verificar puerto
ls /dev/ttyUSB* /dev/ttyACM*

# Probar comunicaciÃ³n
python3 tests/test_serial.py
```

### Video no se muestra
```bash
# Verificar cÃ¡maras
ls /dev/video*
v4l2-ctl --list-devices

# Probar streaming
python3 tests/test_video.py
```

### Sin conexiÃ³n UDP
```bash
# Verificar red
ping 192.168.1.100

# Verificar puertos
netstat -an | grep 50000
```

## ğŸ“ Formato CSV

### marcadores.csv
```csv
timestamp,mode,px_u,px_v,marker_type,light_V,temp_C,humidity_percent,action,notes
2025-11-29 14:00:05,MANUAL,320,240,Cruz,1.23,25.3,0,PHOTO,detectado manualmente
```

### logs.csv
```csv
timestamp,component,level,message
2025-11-29 14:00:05,ROVER,INFO,tomÃ© fotografÃ­a
```

### telemetria.csv
```csv
timestamp,temp_C,light_V,distance_cm,humidity_ambient,imu_ax,imu_ay,imu_az,imu_gx,imu_gy,imu_gz
2025-11-29 14:00:05,25.3,1.23,120,35.2,0.02,-0.01,9.81,0.1,-0.05,0.02
```

## ğŸ” Seguridad

- **Parada de emergencia** tiene mÃ¡xima prioridad
- **Watchdog** evita bloqueos del sistema
- **LÃ­mites de velocidad** configurables
- **Timeouts** en todas las comunicaciones

## ğŸ¤ ContribuciÃ³n

Para reportar problemas o sugerir mejoras, contactar al equipo de desarrollo.

## ğŸ“„ Licencia

Sistema desarrollado para fines educativos.

## ğŸ“§ Contacto

Equipo de Rover de ExploraciÃ³n
Version: 2.0
Fecha: 2025-11-29