# =========================
# CONFIGURACIÓN ROVER DE EXPLORACIÓN
# =========================

# ========== SERVIDOR RASPBERRY PI ==========
server:
  ip: '0.0.0.0'
  udp_port: 50000
  tcp_port: 50001
  buffer_size: 4096

# ========== ARDUINO ==========
arduino:
  port: '/dev/ttyUSB0'  # En Windows sería 'COM3', 'COM4', etc.
  baud_rate: 115200
  timeout: 1.0
  retries: 3

# ========== CÁMARAS ==========
cameras:
  front:
    device: 0  # /dev/video0
    width: 640
    height: 480
    fps: 30
  
  top:
    device: 2  # /dev/video2
    width: 640
    height: 480
    fps: 30
  
  jpeg_quality: 70

# ========== ARCHIVOS DE DATOS ==========
data:
  base_path: './data'
  csv_markers: 'data/marcadores.csv'
  csv_logs: 'data/logs.csv'
  csv_telemetry: 'data/telemetria.csv'
  log_file: 'data/rover.log'

# ========== DETECCIÓN DE MARCADORES ==========
marker_detection:
  # Marcador clave (puede ser: Cruz, T, Círculo, Cuadrado, Triángulo)
  key_marker: 'Círculo'
  
  # Umbral de confianza (0.0 a 1.0)
  confidence_threshold: 0.75
  
  # Rangos Hu Moments para cada figura
  hu_ranges:
    X:
      1: [0.68, 0.75]
      2: [2.7, 5.1]
      3: [0, 6.5]
      4: [5, 7.5]
      5: [-14, 15]
      6: [-12, 11]
      7: [-13.5, 13]
    
    T:
      1: [0.3, 0.7]
      2: [0.5, 4]
      3: [1, 2]
      4: [1, 4]
      5: [-10, 7]
      6: [-5, 6]
      7: [-8, 7]
    
    Circulo:
      1: [0.72, 0.81]
      2: [3.35, 5.1]
      3: [4.5, 6.5]
      4: [5.2, 8.4]
      5: [-17, 18]
      6: [-14, 13]
      7: [-17, 17.5]
    
    Triangulo:
      1: [0.6, 1]
      2: [2, 4]
      3: [2, 4]
      4: [3.5, 6]
      5: [6.5, 10]
      6: [4.8, 10]
      7: [-10, 10]
    
    Cuadrado:
      1: [0.70, 0.89]
      2: [2, 6.5]
      3: [3, 7]
      4: [4, 7.9]
      5: [-15, 15]
      6: [-11, 11]
      7: [-15.7, 14]
  
  # Colores HSV para detección
  colors:
    orange:
      lower: [8, 150, 180]
      upper: [18, 255, 255]
    
    green:
      lower: [35, 120, 150]
      upper: [85, 255, 255]
    
    yellow:
      lower: [22, 140, 150]
      upper: [32, 255, 255]

# ========== CONTROL ==========
control:
  default_speed: 80
  speed_min: 0
  speed_max: 100
  
  # Límites de seguridad
  max_motor_pwm: 255
  
  # Timeouts
  command_timeout: 2.0
  sensor_read_interval: 0.5

# ========== CALIBRACIÓN DE SENSORES ==========
calibration:
  ldr:
    # Mapeo de voltaje a lux (ajustar según calibración)
    v_min: 0.0
    v_max: 5.0
    lux_min: 0
    lux_max: 1000
  
  humidity_capacitive:
    # Valores típicos del EK1940
    dry_value: 550
    wet_value: 280
  
  mpu6050:
    # Offsets de acelerómetro (ajustar tras calibración)
    accel_offset_x: 0.0
    accel_offset_y: 0.0
    accel_offset_z: 0.0
    
    # Offsets de giroscopio
    gyro_offset_x: 0.0
    gyro_offset_y: 0.0
    gyro_offset_z: 0.0
  
  vl53l0x:
    # Timing budget en ms (mayor = más precisión pero más lento)
    timing_budget: 33
    
    # Límite de distancia en mm
    max_range: 2000

# ========== MODOS DE OPERACIÓN ==========
modes:
  manual:
    auto_save: false
    telemetry_rate: 1.0  # segundos
  
  autonomous:
    auto_save: true
    telemetry_rate: 0.5
    marker_scan_rate: 0.1  # segundos entre escaneos
    auto_sample_on_key_marker: true

# ========== SECUENCIA DEL BRAZO ==========
arm_sequence:
  # Posiciones de servos para toma de muestra
  steps:
    - servo: 2
      angle: 45
      delay: 1000  # ms
    
    - servo: 3
      angle: 135
      delay: 1000
    
    - servo: 4
      angle: 90
      delay: 500
    
    - wait: 1000  # Estabilización
    
    - servo: 4
      angle: 45
      delay: 500
    
    - servo: 3
      angle: 90
      delay: 1000
    
    - servo: 2
      angle: 90
      delay: 1000

# ========== LOGGING ==========
logging:
  level: 'INFO'  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  console: true
  file: true
  csv: true

# ========== INTERFAZ CLIENTE ==========
client:
  server_ip: '192.168.1.100'  # IP de la Raspberry Pi
  reconnect_attempts: 5
  reconnect_delay: 3  # segundos
  
  ui:
    window_width: 1400
    window_height: 900
    theme: 'dark'  # dark o light
    
    camera_display:
      width: 480
      height: 360
    
    map:
      scale: 2  # pixels por cm
      max_points: 50
      grid_size: 40